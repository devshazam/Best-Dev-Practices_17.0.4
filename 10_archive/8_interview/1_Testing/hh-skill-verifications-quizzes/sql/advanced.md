## SQL ‚Äî –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å

üèÜ –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: 14 –∏–∑ 15.

#### Q1. –ü–æ–ª—É—á–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω –∏ —Ñ–∞–º–∏–ª–∏–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –æ—Ç–¥–µ–ª–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞, –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Employees.

| Employees  |  |
|---|---|
| employee_id  | Integer  |
|  first_name | String  |
| last_name |  String |
|  department | String  |
|  job_title | String  |
|  salary | Integer  |

- [x] `SELECT first_name, last_name FROM Employees WHERE department = 'Marketing';`

#### Q2. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü email —Å —Ç–∏–ø–æ–º –¥–∞–Ω–Ω—ã—Ö VARCHAR(255) –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É Clients.

- [x] `ALTER TABLE Clients ADD email VARCHAR(255);`

#### Q3. –ö–∞–∫–∏–º –±—É–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–æ–¥–∞ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã Cars, –µ—Å–ª–∏ car_id ‚Äî –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á? –ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ ‚Äî —ç–ª–µ–º–µ–Ω—Ç—ã –≤—ã–≤–æ–¥–∞ —Ç–∞–±–ª–∏—Ü—ã.
`INSERT INTO Cars VALUES distributor_id = 5, car_model = 'BMW X5 M50d';`

|  Cars     |         |
| -------------- | ------- |
| car_id         | Integer |
| distributor_id | Integer |
| car_model      | String  |
| number         | Integer |

–ó–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ Cars

| car_id | distributor_id | car_model              | number |
| ------ | -------------- | ---------------------- | ------ |
| 1      | 1              | BMW X5 M50d           | 10     |
| 2      | 2              | Mercedez-Benz C-Class | 7      |
| 3      | 3              | Lexus LX               | 7      |


- [x] –û—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –æ—à–∏–±–∫–∞

#### Q4. –í—ã —Ö–æ—Ç–∏—Ç–µ –Ω–∞–π—Ç–∏ –∑–∞—Ä–∞–±–æ—Ç–Ω—É—é –ø–ª–∞—Ç—É –æ—Ç–¥–µ–ª–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –æ–±—â–∞—è –∑–∞—Ä–∞–±–æ—Ç–Ω–∞—è –ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 700 000 —Ä—É–±–ª–µ–π, –≤ —Ç–∞–±–ª–∏—Ü–µ Salaries. –ö–∞–∫–∞—è –æ—à–∏–±–∫–∞ –¥–æ–ø—É—â–µ–Ω–∞ –≤ –∑–∞–ø—Ä–æ—Å–µ?

```
SELECT department_id, SUM(salary) AS total_salary FROM Salaries
HAVING total_salary <= 700000 GROUP BY department_id;
```

| Salaries      | |
| ------------- | ---- |
| salary_id     | Integer |
| employee_id   | Integer |
| department_id | Integer |
| salary        | Double |

- [x] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è total_salary <= 700000 –≤–º–µ—Å—Ç–æ SUM(salary) <= 700000

#### Q5. –ù–∞–π–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ, –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è —Ç–æ–ª—å–∫–æ –∫ –ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ Orders, –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö Orders –∏ Clients, —É—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ –æ–±—â–∏–π —Å—Ç–æ–ª–±–µ—Ü –º–µ–∂–¥—É –Ω–∏–º–∏ ‚Äî client_id.
| Orders | |
| --------- | ------- |
| order_id  | Integer |
| client_id | Integer |
| date      | Date    |


| Clients | |
| --------- | ------- |
| client_id    | Integer |
| company_name | String  |
| email        | String  |
| phone        | Double  |

- [x] `SELECT Orders.order_id FROM Orders LEFT JOIN Clients ON Clients.client_id = Orders.client_id WHERE Clients.client_id IS NULL;`

#### Q6. –ù–∞–π–¥–∏—Ç–µ –∏–º–µ–Ω–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∑–∞—Ä–ø–ª–∞—Ç–∞ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∏–∂–µ –º–µ–¥–∏–∞–Ω–Ω–æ–π –∑–∞—Ä–ø–ª–∞—Ç—ã –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ Employees.

| Employees  |         |
| ------------- | ------- |
| employee \_id | Integer |
| first_name    | String  |
| last_name     | String  |
| department    | String  |
| job_title     | String  |
| salary        | Integer |

- [x] `SELECT first_name, last_name FROM Employees WHERE salary < (SELECT MEDIAN(salary) FROM Employees);`

#### Q7. –í–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –∏–º–µ–Ω–µ–º PeopleView —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü Respondents –∏ Info, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è –≤–æ–∑—Ä–∞—Å—Ç, —Ç–µ–ª–µ—Ñ–æ–Ω—ã –∏ –∞–¥—Ä–µ—Å–∞ —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–æ–≤. –ö–∞–∫–∞—è –æ—à–∏–±–∫–∞ –¥–æ–ø—É—â–µ–Ω–∞ –≤ –∑–∞–ø—Ä–æ—Å–µ?

```
CREATE VIEW PeopleView 
AS SELECT age, phone_number, address 
FROM Respondents, Info
WHERE Respondents.respondent_id = Info.respondent_id;
```

|  Respondents  |         |
| -------------- | ------- |
| respondent_id  | Integer |
| city           | String  |
| age            | Integer |
| phone_number   | String  |
| know_languages | Array   |

|   Info  |         |
| ------------- | ------- |
| info_id       | Integer |
| respondent_id | Integer |
| phone_number  | String  |
| address       | String  |

- [x] –ù—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å, –∏–∑ –∫–∞–∫–∏—Ö —Ç–∞–±–ª–∏—Ü –≤–∑—è—Ç—ã –¥–∞–Ω–Ω—ã–µ, —Ç. –µ. Respondents.age, Respondents.phone_number, Info.address

#### Q8. –í—ã —Å–æ–∑–¥–∞–ª–∏ –Ω–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å –≤ —Ç–∞–±–ª–∏—Ü–µ Products –¥–ª—è —Å—Ç–æ–ª–±—Ü–∞ category, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –µ–≥–æ –∑–∞–ø–∏—Å–∏ –∏ –∞–¥—Ä–µ—Å–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Å—Ç—Ä–æ–∫–∏ (–≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ), –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–∞–ø–∏—Å—å —Å—Ç–æ–ª–±—Ü–∞. –ö–∞–∫–æ–π —à–∞–≥ –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –Ω–∏–∂–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞?

```
CREATE INDEX product_category_index

ON Products (category);

SELECT product_name, category, price

FROM Products

WHERE category = 'electronics';
```

|   Products    |         |
| ------------------- | ------- |
| product_id          | Integer |
| product_name        | String  |
| product_subcategory | String  |
| category            | String  |
| price               | Double  |

- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ

#### Q9. –í—ã —Å–æ–∑–¥–∞–ª–∏ —Ç–∞–±–ª–∏—Ü—É:

```
CREATE TABLE yourtable(x int NOT NULL, y int NOT NULL, CONSTRAINT pk_yourtable PRIMARY KEY(x, y));
```

–í—ã–±–µ—Ä–∏—Ç–µ, –∫–∞–∫–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–µ—Ä–≤–æ–π –≤ –ø—Ä–æ—Ü–µ–¥—É—Ä–µ, —Ä–∞–±–æ—Ç–∞—é—â–µ–π —Å –æ—à–∏–±–∫–∞–º–∏ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏.

- [x] SET XACT_ABORT, NOCOUNT ON

#### Q10. –£ –≤–∞—Å –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ Orders —Å –º–∏–ª–ª–∏–æ–Ω–æ–º —Å—Ç—Ä–æ–∫ –∏ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å—Ç–æ–ª–±—Ü–æ–º order_date, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª —Å–æ–∑–¥–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:

```
CREATE INDEX order_index ON Orders(order_date);
```

–ö–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –≤—ã –±—É–¥–µ—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∑–∞–∫–∞–∑–µ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã?

- [x] –ò—Å–ø–æ–ª—å–∑—É—é –ø–æ–¥–∑–∞–ø—Ä–æ—Å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π order_date –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞, –∞ –∑–∞—Ç–µ–º –æ–±—ä–µ–¥–∏–Ω—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ç–∞–±–ª–∏—Ü–µ–π Orders, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–∫–∞–∑–µ

#### Q11. –ù–∞–ø–∏—à–∏—Ç–µ SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–±–µ—Ä–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Customers, —É –∫–æ—Ç–æ—Ä—ã—Ö –∏–º—è (name) –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ –±—É–∫–≤—É "A" –∏–ª–∏ "M", –∏ –≤–æ–∑—Ä–∞—Å—Ç (age) –±–æ–ª—å—à–µ 25 –ª–µ—Ç. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å–ø–∏—Å–æ–∫ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è –≤–æ–∑—Ä–∞—Å—Ç–∞.

- [x] ```SELECT * FROM Customers
WHERE (name LIKE 'A%' OR name LIKE 'M%') AND age > 25
ORDER BY age DESC```

#### Q12. –í—ã –¥–∞–µ—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–ª–∏ –∑–∞–ø—Ä–µ—Ç –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ –æ–±—ä–µ–∫—Ç–∞–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–∏. –ö–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ?

- [x] GRANT, REVOKE

#### Q13. –ö–∞–∫—É—é –∑–∞–¥–∞—á—É –º–æ–∂–µ—Ç —Ä–µ—à–∞—Ç—å –¥–∞–Ω–Ω—ã–π –∫–æ–¥?

```
SELECT product_name,
CASE WHEN (price > 100) THEN 'expensive'
ELSE 'cheap'
END AS product_cost
FROM cd.database;
```

- [x] –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –¥–æ—Ä–æ–≥–∏—Ö –∏ –¥–µ—à–µ–≤—ã—Ö —Ç–æ–≤–∞—Ä–∞—Ö, –≥–¥–µ –¥–æ—Ä–æ–≥–∏–º–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è —Ç–æ–≤–∞—Ä—ã –¥–æ—Ä–æ–∂–µ 100 —Ä—É–±–ª–µ–π. –ü—Ä–∏ —ç—Ç–æ–º –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ç–æ–≤–∞—Ä–æ–≤ –≤ –æ–¥–Ω–æ–º —Å—Ç–æ–ª–±–∏–∫–µ –∏ —É–∫–∞–∑–∞–Ω–∏–µ–º –¥–æ—Ä–æ–≥–æ–π –æ–Ω –∏–ª–∏ –¥–µ—à–µ–≤—ã–π –≤ –¥—Ä—É–≥–æ–º.

#### Q14. –í–∞–º –Ω—É–∂–µ–Ω –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ —Å–ø–∏—Å–æ–∫ –∏–∑ 10 –Ω–µ–ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∏–º—ë–Ω –≤ —Ç–∞–±–ª–∏—Ü–µ group_A. –° –ø–æ–º–æ—â—å—é –∫–∞–∫–æ–≥–æ –∫–æ–¥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ—à–µ–Ω–∞ –¥–∞–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞?

- [x] ‚Üì
```
SELECT distinct surname
FROM group_A
ORDER BY surname
LIMIT 10; 
```

#### Q15. –£ –≤–∞—Å –µ—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã: workers –∏ salary. –ü–µ—Ä–≤–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π id —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –µ–≥–æ —Ñ–∞–º–∏–ª–∏—é (surname) –∏ –¥–æ–ª–∂–Ω–æ—Å—Ç—å (position). –í–æ –≤—Ç–æ—Ä–æ–π —Ç–∞–±–ª–∏—Ü–µ —É–∫–∞–∑–∞–Ω–æ: id –¥–æ–ª–∂–Ω–æ—Å—Ç–∏, —Å–∞–º–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç—å –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –µ–π –∑–∞—Ä–ø–ª–∞—Ç–∞. –í–∞–º –Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫. –ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –∫–æ–¥–∞ —Å–º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å –¥–∞–Ω–Ω—É—é –∑–∞–¥–∞—á—É?

- [x] ```SELECT *
FROM workers w JOIN salary s ON w.position = s.position;```
